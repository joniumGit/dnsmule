version: '0.0.1'
rules:
  - o365:
    type: dns.regex
    record: txt
    pattern: '^MS=ms'
    identification: MICROSOFT::O365
  - ses:
    type: dns.regex
    record: txt
    pattern: '^amazonses:'
    identification: AMAZON::SES
  - azure:
    type: dns.regex
    record: txt
    pattern: '^.*\.azurewebsites\.'
    identification: MICROSOFT::AZURE
  - generic_verification:
    type: dns.regex
    record: txt
    patterns:
      - '^(.+)(?:-(?:site|domain))?-verification='
      - '^(.+)(?:site|domain)verification'
      - '^(.+)_verify_'
      - '^(\w+)-code:'
    group: 1
  - dynamic_rule:
    type: dns.dynamic
    record: txt
    code: |+0
      some_global_variable = []
      
      
      def initialize():
          some_global_variable[0] = 1
          add_rule(
              Type.TXT,
              'dns.regex',
              name='example_rule_1',
              pattern=fr'^dynamic$',
              identification='example',
          )
      
      
      def process(record: Record) -> Result:
          assert some_global_variable[0] == 1
          add_rule(
              Type.CNAME,
              'dns.regex',
              name='example_rule_2',
              pattern=fr'^dynamic$',
              identification='example',
          )
          return record.result()